const instrumentInfo = {
 dantranh: {
  name: "ÄÃ n Tranh",
  desc: `ÄÃ n tranh (cÃ²n gá»i lÃ  Ä‘Ã n tháº­p lá»¥c) lÃ  nháº¡c cá»¥ dÃ¢y truyá»n thá»‘ng
cá»§a cÃ¡c quá»‘c gia phÆ°Æ¡ng ÄÃ´ng, trong Ä‘Ã³ cÃ³ Viá»‡t Nam.
Nháº¡c cá»¥ nÃ y cÃ³ xuáº¥t xá»© tá»« Trung Quá»‘c vÃ  Ä‘Ã£ Ä‘Æ°á»£c Viá»‡t hÃ³a,
giá»¯ vá»‹ trÃ­ quan trá»ng trong Ã¢m nháº¡c dÃ¢n gian vÃ  cáº£i lÆ°Æ¡ng.

ÄÃ n tranh thuá»™c há» dÃ¢y, chi gáº£y.
Do ban Ä‘áº§u cÃ³ 16 dÃ¢y nÃªn cÃ²n Ä‘Æ°á»£c gá»i lÃ  Ä‘Ã n Tháº­p lá»¥c.

ÄÃ n cÃ³ hÃ¬nh há»™p chá»¯ nháº­t dÃ i,
thÆ°á»ng Ä‘Æ°á»£c cháº¿ táº¡o tá»« cÃ¡c loáº¡i gá»— tá»‘t nhÆ° gá»— thÃ´ng hoáº·c gá»— hÆ°Æ¡ng,
giÃºp táº¡o Ä‘á»™ bá»n vÃ  Ã¢m sáº¯c Ä‘áº·c trÆ°ng.

Cáº¥u táº¡o Ä‘Ã n tranh gá»“m:
1. ThÃ¢n Ä‘Ã n: LÃ  há»™p gá»— dÃ i, giÃºp cá»™ng hÆ°á»Ÿng Ã¢m thanh tá»‘t.
2. DÃ¢y Ä‘Ã n: ThÆ°á»ng tá»« 16 Ä‘áº¿n 25 dÃ¢y, lÃ m báº±ng kim loáº¡i hoáº·c tÆ¡.
3. Cáº§u Ä‘Ã n (con nháº¡n): DÃ¹ng Ä‘á»ƒ nÃ¢ng dÃ¢y vÃ  Ä‘iá»u chá»‰nh cao Ä‘á»™.
4. Trá»¥c chá»‰nh Ã¢m: Äiá»u chá»‰nh Ä‘á»™ cÄƒng cá»§a dÃ¢y, táº¡o cÃ¡c Ã¢m vá»±c khÃ¡c nhau theo ngÅ© cung.

ÄÃ n tranh cÃ³ nhiá»u loáº¡i vÃ  kiá»ƒu dÃ¡ng khÃ¡c nhau,
pháº£n Ã¡nh Ä‘áº·c Ä‘iá»ƒm vÄƒn hÃ³a Ã¢m nháº¡c cá»§a tá»«ng quá»‘c gia vÃ  vÃ¹ng miá»n.`
},
saotruc: {
  name: "SÃ¡o TrÃºc",
  desc: `SÃ¡o trÃºc lÃ  nháº¡c cá»¥ hÆ¡i truyá»n thá»‘ng cá»§a Viá»‡t Nam, Ä‘Æ°á»£c lÃ m chá»§ yáº¿u tá»« tre hoáº·c trÃºc.
SÃ¡o cÃ³ Ã¢m thanh trong tráº»o, mÆ°á»£t mÃ , gáº¯n liá»n vá»›i Ä‘á»i sá»‘ng sinh hoáº¡t vÃ  vÄƒn hÃ³a dÃ¢n gian.

Cáº¥u táº¡o sÃ¡o trÃºc gá»“m:
1. á»ng sÃ¡o: LÃ m báº±ng tre/trÃºc, rá»—ng ruá»™t.
2. Lá»— thá»•i: DÃ¹ng Ä‘á»ƒ táº¡o luá»“ng hÆ¡i.
3. CÃ¡c lá»— báº¥m: ThÆ°á»ng tá»« 6â€“10 lá»— Ä‘á»ƒ thay Ä‘á»•i cao Ä‘á»™.

SÃ¡o trÃºc thÆ°á»ng Ä‘Æ°á»£c dÃ¹ng trong nháº¡c dÃ¢n gian, nháº¡c lá»…, biá»ƒu diá»…n Ä‘á»™c táº¥u.`
},

  dankim: {
  name: "ÄÃ n KÃ¬m",
  desc: `ÄÃ n kÃ¬m (cÃ²n gá»i lÃ  Ä‘Ã n nguyá»‡t) lÃ  nháº¡c cá»¥ truyá»n thá»‘ng cá»§a Viá»‡t Nam, thuá»™c há» dÃ¢y.
Nháº¡c cá»¥ nÃ y cÃ³ nguá»“n gá»‘c tá»« Trung Quá»‘c nhÆ°ng Ä‘Ã£ Ä‘Æ°á»£c Viá»‡t hÃ³a vÃ  sá»­ dá»¥ng rá»™ng rÃ£i
trong ca trÃ¹, chÃ¨o, cáº£i lÆ°Æ¡ng vÃ  nháº¡c cung Ä‘Ã¬nh Huáº¿.

ÄÃ n kÃ¬m cÃ³ hÃ¬nh trÃ²n nhÆ° máº·t trÄƒng, cáº§n Ä‘Ã n dÃ i, thÆ°á»ng cÃ³ 2 dÃ¢y,
giá»¯ vai trÃ² quan trá»ng trong dÃ n nháº¡c tÃ i tá»­ vÃ  sÃ¢n kháº¥u cáº£i lÆ°Æ¡ng.

Cáº¥u táº¡o Ä‘Ã n kÃ¬m gá»“m:
1. ThÃ¢n Ä‘Ã n: HÃ¬nh trÃ²n, lÃ m báº±ng gá»—, giÃºp cá»™ng hÆ°á»Ÿng Ã¢m thanh.
2. Cáº§n Ä‘Ã n: DÃ i, cÃ³ phÃ­m, dÃ¹ng Ä‘á»ƒ báº¥m ná»‘t.
3. DÃ¢y Ä‘Ã n: ThÆ°á»ng lÃ m báº±ng tÆ¡ hoáº·c nylon.
4. Trá»¥c lÃªn dÃ¢y: DÃ¹ng Ä‘á»ƒ Ä‘iá»u chá»‰nh Ä‘á»™ cÄƒng vÃ  cao Ä‘á»™ cá»§a dÃ¢y.

Ã‚m thanh Ä‘Ã n kÃ¬m trong, vang, trang nghiÃªm,
thÃ­ch há»£p Ä‘á»ƒ diá»…n táº£ nhá»¯ng cáº£m xÃºc sÃ¢u láº¯ng vÃ  trá»¯ tÃ¬nh.`
},

danco: {
  name: "ÄÃ n CÃ²",
  desc: `ÄÃ n cÃ² (cÃ²n gá»i lÃ  Ä‘Ã n nhá»‹) lÃ  nháº¡c cá»¥ truyá»n thá»‘ng cá»§a Viá»‡t Nam,
thuá»™c há» dÃ¢y kÃ©o, giá»¯ vai trÃ² quan trá»ng trong Ã¢m nháº¡c dÃ¢n gian.

ÄÃ n cÃ² cÃ³ 2 dÃ¢y, Ã¢m thanh da diáº¿t, rÃ©o ráº¯t,
thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ diá»…n táº£ nhá»¯ng cáº£m xÃºc buá»“n,
sÃ¢u láº¯ng vÃ  giÃ u ná»™i tÃ¢m.

Cáº¥u táº¡o Ä‘Ã n cÃ² gá»“m:
1. Báº§u Ä‘Ã n: ThÆ°á»ng lÃ m báº±ng gá»—, máº·t bá»c da ráº¯n hoáº·c da trÄƒn.
2. Cáº§n Ä‘Ã n: DÃ i, khÃ´ng cÃ³ phÃ­m.
3. DÃ¢y Ä‘Ã n: Gá»“m hai dÃ¢y, lÃ m báº±ng tÆ¡ hoáº·c kim loáº¡i.
4. Cung kÃ©o: LÃ m báº±ng gá»— vÃ  lÃ´ng Ä‘uÃ´i ngá»±a, dÃ¹ng Ä‘á»ƒ kÃ©o dÃ¢y táº¡o Ã¢m thanh.

ÄÃ n cÃ² thÆ°á»ng xuáº¥t hiá»‡n trong dÃ n nháº¡c dÃ¢n tá»™c,
nháº¡c lá»…, cáº£i lÆ°Æ¡ng vÃ  hÃ¡t chÃ¨o.`
},

songlang: {
  name: "Song Lang",
  desc: `Song lang lÃ  nháº¡c cá»¥ gÃµ truyá»n thá»‘ng cá»§a Viá»‡t Nam,
thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong Ä‘á»n ca tÃ i tá»­ vÃ  sÃ¢n kháº¥u cáº£i lÆ°Æ¡ng.

Nháº¡c cá»¥ nÃ y cÃ³ cáº¥u táº¡o Ä‘Æ¡n giáº£n,
giá»¯ vai trÃ² quan trá»ng trong viá»‡c giá»¯ nhá»‹p cho dÃ n nháº¡c.

Cáº¥u táº¡o song lang gá»“m:
1. Hai miáº¿ng gá»— hoáº·c tre: ÄÆ°á»£c gÃµ vÃ o nhau Ä‘á»ƒ phÃ¡t ra Ã¢m thanh.
2. CÆ¡ cáº¥u báº­t: GiÃºp táº¡o tiáº¿ng â€œcá»‘câ€ hoáº·c â€œtÃ¡châ€ rÃµ rÃ ng.

Ã‚m thanh song lang ngáº¯n, gá»n, rÃµ nhá»‹p,
giÃºp dáº«n dáº¯t tiáº¿t táº¥u vÃ  giá»¯ sá»± á»•n Ä‘á»‹nh cho toÃ n bá»™ dÃ n nháº¡c.`
},


};

const player = document.getElementById("sample-player");
player.volume = 0.7;

let audioUnlocked = false;

document.addEventListener("click", () => {
  if (audioUnlocked) return;

  audioUnlocked = true;

  player.src = "";
  player.play().catch(() => {});
  player.pause();

  console.log("ðŸ”“ Audio unlocked");
}, { once: true });

document.querySelectorAll(".card.instrument").forEach(card => {
  card.addEventListener("click", () => {
    if (!audioUnlocked) return;

    const audioSrc = card.dataset.audio;
    if (!audioSrc) return;

    player.pause();
    player.src = audioSrc;
    player.currentTime = 0;
    player.play().catch(err => {
      console.log("Play error:", err);
    });
  });
});


const popup = document.getElementById("info-popup");
const popupName = document.getElementById("popup-name");
const popupDesc = document.getElementById("popup-desc");

let hideTimeout;
let isHoveringCard = false;
let isHoveringPopup = false;

document.querySelectorAll(".card.instrument").forEach(card => {
  card.addEventListener("mouseenter", () => {
    const id = card.dataset.id;
    const data = instrumentInfo[id];
    if (!data) return;

    popupName.innerText = data.name;
    popupDesc.innerText = data.desc;

    popup.style.visibility = "hidden";
    popup.classList.add("show");

    requestAnimationFrame(() => {
      const rect = card.getBoundingClientRect();
      const popupWidth = popup.offsetWidth;
      const popupHeight = popup.offsetHeight;

      let left = rect.right + 15;
      if (left + popupWidth > window.innerWidth - 10) {
        left = rect.left - popupWidth - 15;
        if (left < 10) left = 10;
      }

      let top = rect.top + window.scrollY;
      if (top + popupHeight > window.scrollY + window.innerHeight - 10) {
        top = window.scrollY + window.innerHeight - popupHeight - 10;
      }
      if (top < window.scrollY + 10) top = window.scrollY + 10;

      popup.style.left = left + "px";
      popup.style.top = top + "px";
      popup.style.visibility = "visible";
    });

    isHoveringCard = true;
    if (hideTimeout) clearTimeout(hideTimeout);
  });

  card.addEventListener("mouseleave", () => {
    isHoveringCard = false;
    hideTimeout = setTimeout(() => {
      if (!isHoveringPopup) popup.classList.remove("show");
    }, 250);
  });
});

popup.addEventListener("mouseenter", () => {
  isHoveringPopup = true;
  if (hideTimeout) clearTimeout(hideTimeout);
});

popup.addEventListener("mouseleave", () => {
  isHoveringPopup = false;
  hideTimeout = setTimeout(() => {
    if (!isHoveringCard) popup.classList.remove("show");
  }, 250);
});

  card.addEventListener('click', () => {
    const name = card.querySelector('h4').textContent;
    const audioSrc = card.dataset.audio;

    popupName.textContent = name;
    popupDesc.textContent = `Báº¡n Ä‘ang nghe nháº¡c cá»¥: ${name}. Nháº¥n play Ä‘á»ƒ nghe thá»­.`

    const player = document.getElementById('sample-player');
    player.src = audioSrc;
    player.play();

    popup.classList.add('show');
  });


popup.addEventListener('click', (e) => {
  if(e.target === popup) {
    popup.classList.remove('show');
    const player = document.getElementById('sample-player');
    player.pause();
  }
});
